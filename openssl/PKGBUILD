pkgname=openssl
pkgver=3.0.2
source=(https://www.openssl.org/source/$pkgname-$pkgver.tar.gz)

build() {
	cd $pkgname-$pkgver

	./config --prefix=/tools             \
	         --openssldir=/tools/etc/ssl \
	         --libdir=lib                \
	         shared                      \
	         no-ssl3-method
	make
	make -j1 MANSUFFIX=ssl install

	make distclean

	MACHINE="i686"                    \
	CC="${LFS_TGT}-gcc -m32"          \
	CXX="${LFS_TGT}-g++ -m32"         \
	    ./config                      \
	    --prefix=/tools               \
	    --openssldir=/tools/etc/ssl   \
	    --libdir=lib32                \
	    shared                        \
	    no-ssl3-method
	    
	make
	make DESTDIR=$PWD/DESTDIR install
	cp -Rv DESTDIR/tools/lib32/* /tools/lib32
}
